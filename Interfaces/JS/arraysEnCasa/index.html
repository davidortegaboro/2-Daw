<html>

<body>
    <h2>Arrays de Objetos</h2>

    <button onclick="notasAlumno()">Notas de un alumno</button><br>
    <p>

        <button onclick="subeUnPunto()">Subir un punto en cada asignatura</button><br>
    <p>

        <button onclick="alumnosCiudad()">Buscar alumnos de una ciudad</button>
        <button onclick="alumnosCurso()">Buscar alumnos de un curso</button><br>
    <p>

        <button onclick="ordenaEdad()">Ordenar alumnos por edad</button>
        <button onclick="ordenaNombreAsc()">Ordenar alumnos por nombre ascendente</button>
        <button onclick="ordenaNombreDesc()">Ordenar alumnos por nombre descendente</button><br>
    <p>

        <button onclick="borraAlumno()">Borrar alumno</button><br>
    <p>

        <button onclick="nuevoAlumno()">Nuevo alumno</button>
        <button onclick="nuevaAsignatura()">Nueva asignatura</button>

</body>

<script>
    "use strict"
    let alumnos = [{
        'codigo': 'DAW-1-2020',
        'nombre': 'Pepe',
        'ciudad': 'Valencia',
        'calificaciones': [{ 'asignatura': 'PRG', 'nota': 9 },
        { 'asignatura': 'GBD', 'nota': 6 },
        { 'asignatura': 'ING', 'nota': 4 },
        { 'asignatura': 'FOL', 'nota': 3 }
        ],
        'edad': 24
    },
    {
        'codigo': 'DAW-2-2020',
        'nombre': 'Juan',
        'ciudad': 'Castellon',
        'calificaciones': [{ 'asignatura': 'DWC', 'nota': 4 },
        { 'asignatura': 'DWS', 'nota': 6 },
        { 'asignatura': 'DAW', 'nota': 7 },
        { 'asignatura': 'DIW', 'nota': 8 },
        { 'asignatura': 'ING', 'nota': 9 },
        { 'asignatura': 'EIE', 'nota': 2 }
        ],
        'edad': 28
    },
    {
        'codigo': 'DAW-1-2019',
        'nombre': 'Ana',
        'ciudad': 'Valencia',
        'calificaciones': [{ 'asignatura': 'PRG', 'nota': 6 },
        { 'asignatura': 'GBD', 'nota': 2 },
        { 'asignatura': 'ING', 'nota': 6 },
        { 'asignatura': 'FOL', 'nota': 2 }
        ],
        'edad': 22
    },
    {
        'codigo': 'DAW-2-2020',
        'nombre': 'Maria',
        'ciudad': 'Castellon',
        'calificaciones': [{ 'asignatura': 'DWC', 'nota': 4 },
        { 'asignatura': 'DWS', 'nota': 6 },
        { 'asignatura': 'DAW', 'nota': 7 },
        { 'asignatura': 'DIW', 'nota': 8 },
        { 'asignatura': 'ING', 'nota': 4 },
        { 'asignatura': 'EIE', 'nota': 1 }
        ],
        'edad': 30
    }
    ]

    function notasAlumno() {


        let inNombreAlumno = prompt("Inserte el nombre del alumno");

        let nombreAlumnoFormateado = inNombreAlumno.trim();

        let alumnosFiltrados = alumnos.filter(a => (a.nombre === nombreAlumnoFormateado));

        if (alumnosFiltrados.length === 0) {
            return console.log("No se ha encontrado a ningun alumno");
        }

        let notamedia = 0;
        let notaMayor = 0;
        let nombreNotaMayor = "";
        let notaMenor = 10;
        let nombreNotaMenor = "";


        alumnosFiltrados.forEach(alumno => {
            alumno.calificaciones.forEach(calificacion => {

                notamedia += calificacion.nota;

                if (notaMayor < calificacion.nota) {
                    notaMayor = calificacion.nota;
                    nombreNotaMayor = calificacion.asignatura;
                }

                if (notaMenor > calificacion.nota) {
                    notaMenor = calificacion.nota;
                    nombreNotaMenor = calificacion.asignatura;
                }

            })

            notamedia = notamedia / alumno.calificaciones.length;

            console.log(`La nota media de ${nombreAlumnoFormateado}, es ${notamedia}`);
            console.log(`La nota maxima de ${nombreAlumnoFormateado}, es ${notaMayor} en ${nombreNotaMayor}`);
            console.log(`La nota minima de ${nombreAlumnoFormateado}, es ${notaMenor} en ${nombreNotaMenor}`);
        }
        )
    }


    function subeUnPunto() {

        alumnos.forEach(alumno => {
            alumno.calificaciones.forEach(c => c.nota += 1)
        })

        console.log(alumnos);
    }

    function alumnosCiudad() {

        let nombreCiudad = prompt("Inserte el nombre de la ciudad").trim();

        let ciudadAlumno = alumnos.filter(a => (a.ciudad === nombreCiudad));

        if (ciudadAlumno.length === 0) {
            return console.log("No se ha encontrado a ningun alumno con esa ciudad");
        }

        ciudadAlumno.forEach(c => console.log(c.nombre));
    }

    function alumnosCurso() {

        let numeroDeCurso = prompt("Inserte el numero del curso").trim();

        if (numeroDeCurso === "") {
            return console.log("No ha insertado nada");
        }

        let curso = [];

        alumnos.forEach(alumno => {

            curso = alumno.codigo.split("-");

            if (curso[1] === numeroDeCurso) {
                console.log(alumno.nombre);
            }
        })
    }


</script>

</html>